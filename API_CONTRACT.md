# API Contract

## Общие требования
* **Базовый URL:** `/api/v1`
* **Заголовки:**
    * `X-City-ID` — ID текущего города пользователя. Необходим для формирования актуальных цен и проверки доступности услуг в конкретном регионе.

## 1. Справочники категорий (Сайдбар)
Получение структуры каталога для построения бокового меню. Структура берется из справочников ЛИС.

`GET /api/v1/categories`

Параметры запроса (Query Params):
* `type` (optional): 'analysis' | 'complex' (для разделения вкладок)

Ответ: `Category[]`

```typescript
export type CatalogTab = 'analysis' | 'complex';
```

```typescript
interface Category {
  id: number;      // Уникальный ID (number или string нужно решить что будет)
  slug: string;             // ЧПУ для URL (напр. "covid-19")
  name: string;             // Название ("Биохимические исследования")
  children?: Category[];    // Подкатегории (вложенность)
}
```

### Пример ответа (Response) - на знаю что вернет ЛИС
Возвращает дерево категорий.


```json
[
  {
    "id": 100,
    "slug": "covid-19",      // вставляем в URL путь
    "name": "COVID-19",
    "children": []           // Массив подкатегорий (рекурсивно)
  },
  {
    "id": 200,
    "slug": "biohimiya",
    "name": "Биохимические исследования",
    "children": [
       {
         "id": 201,
         "slug": "vitamins",
         "name": "Витамины",
         "children": []
       }
    ]
  }
]
```

## 2. Анализ / Товар

`GET /api/v1/analyses`

```typescript
interface Analysis {
  // Идентификаторы
  id: string;               // UUID или ID из базы
  article: string;          // Артикул (напр. "15.105")
  slug: string;             // ЧПУ для URL (напр. "clinical-blood-test")
  limit?: number;            // Ограничение для пагинации
  
  // Основная инфо
  name: string;             // Полное название
  description?: string;     // Краткое описание (для списков и SEO)
  
  // Связи
  categorySlug: string;     // Slug родительской категории (для связи с Category)

  // Цены
  price: number;            // Текущая цена в выбранном городе
  discount?: number | null; // Процент скидки
  biomaterialPrice?: number;// Стоимость взятия биоматериала

  // Медицинские данные
  biomaterial?: string;     // Тип материала
  deadline: string;         // Срок выполнения
  preparation?: string;     // Text: Как подготовиться
  interpretation?: string;  // Text: Интерпретация результатов
  indications?: string;     // Text: Показания к применению
  method?: string;          // Метод исследования
  synonyms?: string;        // Синонимы для поиска

  // (UI Флаги)
  badges?: Array<'popular' | 'new' | 'discount' | 'hit'>; // скорее всего не понадобится, популярные и хиты отдаются бэкендом
}
```

### Пример ответа (Response)
```json
[
    {
        "id": "1",
        "article": "15.105",
        "slug": "clinical-blood-test",
        "categorySlug": "general",     // Связь с категорией "Общеклинические"
        "name": "Клинический анализ крови: общий анализ, лейкоформула, СОЭ",
        "price": 690,
        "deadline": "1 день",
        "biomaterial": "Венозная кровь",
        "method": "Проточная цитофлуометрия, капиллярная микрофотометрия",
        "description": "Клинический анализ крови (КАК) — это одно из самых распространенных лабораторных исследований, которое используется для оценки общего состояния здоровья. Он включает в себя определение количества эритроцитов, лейкоцитов, тромбоцитов, уровня гемоглобина и скорости оседания эритроцитов (СОЭ).",
        "preparation": "
                Кровь рекомендуется сдавать утром (в период с 8 до 11 часов), натощак (не менее 8 и не более 14 часов голодания, воду пить можно).
                Накануне избегать пищевых перегрузок.
                Исключить физическое и эмоциональное перенапряжение и не курить 30 минут до сдачи крови.
        ",
        "interpretation": "
            Результаты анализа должны интерпретироваться врачом. Отклонение показателей от нормы может свидетельствовать о наличии воспалительных процессов, анемии, инфекционных заболеваний и других патологий.
        ",
        "indications": "
            Подозрение на инфекционно-воспалительные заболевания.
            Профилактическое обследование.
            Мониторинг проводимой терапии.
        ",
        "synonyms": "ОАК, CBC, ESR, общий анализ крови",
        "biomaterialPrice": 150,
        "discount": 0,
        "badges": ["popular"], // для формирования популярных анализов
    },
    {
        "id": "2",
        "article": "22.101",
        "slug": "vitamin-d",
        "categorySlug": "vitamins", // Связь с категорией "Витамины"
        "name": "Витамин D, 25-OH (кальциферол)",
        "price": 1990,
        "discount": 20,
        "deadline": "1 день",
        "biomaterial": "Венозная кровь",
        "method": "Хемилюминесцентный иммуноанализ",
        "description": "Исследование уровня витамина D в крови, необходимого для усвоения кальция и фосфора, а также для поддержания иммунитета.",
        "preparation": "
            Не курить в течение 30 минут до исследования.
            Можно сдавать кровь в течение дня, не ранее, чем через 3 часа после приема пищи или утром натощак.
            Рекомендуется исключить прием витамина D за 3-4 дня до исследования (по согласованию с врачом).
        ",
        "interpretation": "
            Нормальный уровень витамина D: 30-100 нг/мл. Недостаточность: 20-30 нг/мл. Дефицит: менее 20 нг/мл.
            Низкий уровень может указывать на риск остеопороза, мышечной слабости, снижения иммунитета. Повышенный уровень может свидетельствовать об избыточном приеме витамина D.
        ",
        "indications": "
            Диагностика дефицита витамина D.
            Остеопороз.
            Контроль терапии препаратами витамина D.
        ",
        "synonyms": "Vitamin D, 25-OH",
        "biomaterialPrice": 350,
        "badges": ["popular", "discount"], // популярные и скидка
    },
]
```